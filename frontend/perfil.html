<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meu Perfil - Portal Not√≠cias</title>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="assets/css/style.css">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="assets/images/favicon.ico">
    
    <style>
        .profile-sidebar {
            position: sticky;
            top: 20px;
        }
        
        .profile-avatar {
            position: relative;
            display: inline-block;
        }
        
        .profile-avatar img {
            width: 120px;
            height: 120px;
            object-fit: cover;
        }
        
        .avatar-upload {
            position: absolute;
            bottom: 0;
            right: 0;
        }
        
        .profile-stats .stat {
            text-align: center;
        }
        
        .profile-stats .stat h5 {
            margin-bottom: 0;
            color: var(--primary-red);
        }
        
        .profile-content {
            min-height: 500px;
        }
        
        .section-content {
            display: none;
        }
        
        .section-content.active {
            display: block;
        }
        
        .activity-item {
            border-left: 3px solid var(--primary-red);
            padding-left: 15px;
            margin-bottom: 20px;
        }
        
        .activity-date {
            font-size: 0.875rem;
            color: #6c757d;
        }
        
        .notification-item {
            padding: 15px;
            border-bottom: 1px solid #eee;
            transition: background-color 0.3s;
        }
        
        .notification-item:hover {
            background-color: #f8f9fa;
        }
        
        .notification-item.unread {
            background-color: #fff3cd;
            border-left: 4px solid var(--primary-red);
        }
        
        .form-floating {
            margin-bottom: 1rem;
        }
        
        .preferences-section {
            margin-bottom: 2rem;
        }
        
        .preferences-section h6 {
            color: var(--primary-red);
            border-bottom: 2px solid var(--primary-red);
            padding-bottom: 0.5rem;
            margin-bottom: 1rem;
        }
        
        @media (max-width: 991.98px) {
            .profile-sidebar {
                position: static;
                margin-bottom: 2rem;
            }
        }
    </style>
    
    <script>
        // Fun√ß√£o para mostrar data atual
        function updateCurrentDate() {
            const now = new Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            };
            document.getElementById('current-date').textContent = 
                now.toLocaleDateString('pt-BR', options);
        }
        
        // Atualizar data quando a p√°gina carregar
        document.addEventListener('DOMContentLoaded', updateCurrentDate);
    </script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <!-- Header Top -->
        <div class="header-top">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-md-6">
                        <div class="d-flex align-items-center">
                            <span class="me-3">
                                <i class="fas fa-calendar-alt me-1"></i>
                                <span id="current-date"></span>
                            </span>
                            <span>
                                <i class="fas fa-thermometer-half me-1"></i>
                                <span id="weather-info">25¬∞C</span>
                            </span>
                        </div>
                    </div>
                    <div class="col-md-6 text-right">
                        <div class="d-flex align-items-center justify-content-end">
                            <div class="social-links me-3">
                                <a href="#" class="me-2" aria-label="Facebook">
                                    <i class="fab fa-facebook-f"></i>
                                </a>
                                <a href="#" class="me-2" aria-label="Twitter">
                                    <i class="fab fa-twitter"></i>
                                </a>
                                <a href="#" class="me-2" aria-label="Instagram">
                                    <i class="fab fa-instagram"></i>
                                </a>
                                <a href="#" aria-label="YouTube">
                                    <i class="fab fa-youtube"></i>
                                </a>
                            </div>
                            <div class="user-actions">
                                <div class="logged-in-only">
                                    <div class="dropdown">
                                        <button class="btn btn-sm btn-outline-primary dropdown-toggle" type="button" data-bs-toggle="dropdown">
                                            <i class="fas fa-user me-1"></i>
                                            <span data-user-info="nome" id="user-name">Usu√°rio</span>
                                        </button>
                                        <div class="dropdown-menu">
                                            <a class="dropdown-item" href="perfil.html">
                                <i class="fas fa-user me-2"></i>Meu Perfil
                            </a>
                            <a class="dropdown-item" href="favoritos.html">
                                <i class="fas fa-heart me-2"></i>Favoritos
                            </a>
                                            <a class="dropdown-item admin-only" href="/admin/" style="display: none;">
                                                <i class="fas fa-cogs me-2"></i>Painel Administrativo
                                            </a>
                                            <div class="dropdown-divider"></div>
                                            <a class="dropdown-item" href="#" onclick="logout()">
                                                <i class="fas fa-sign-out-alt me-2"></i>Sair
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <button class="theme-toggle ms-3" aria-label="Alternar tema">
                                üåô
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Header Main -->
        <div class="header-main">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-md-3">
                        <a href="/" class="logo">
                            <i class="fas fa-newspaper me-2"></i>
                            Portal Not√≠cias
                        </a>
                    </div>
                    <div class="col-md-6">
                        <form class="search-form mx-auto">
                            <div class="position-relative">
                                <input type="text" class="form-control search-input" placeholder="Buscar not√≠cias..." autocomplete="off">
                                <button type="submit" class="search-btn" aria-label="Buscar">
                                    <i class="fas fa-search"></i>
                                </button>
                                <div class="search-suggestions" style="display: none;"></div>
                            </div>
                        </form>
                    </div>
                    <div class="col-md-3 text-right">
                        <div class="d-flex align-items-center justify-content-end">
                            <a href="newsletter.html" class="btn btn-outline-secondary btn-sm me-2">
                                <i class="fas fa-envelope me-1"></i>
                                Newsletter
                            </a>
                            <a href="/rss" class="btn btn-outline-secondary btn-sm" target="_blank">
                                <i class="fas fa-rss me-1"></i>
                                RSS
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Navigation -->
        <nav class="navbar">
            <div class="container">
                <div class="d-flex align-items-center justify-content-between w-100">
                    <ul class="nav-menu">
                        <li class="nav-item">
                            <a href="/" class="nav-link">
                                <i class="fas fa-home me-1"></i>
                                In√≠cio
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="/categoria/politica" class="nav-link">Pol√≠tica</a>
                        </li>
                        <li class="nav-item">
                            <a href="/categoria/economia" class="nav-link">Economia</a>
                        </li>
                        <li class="nav-item">
                            <a href="/categoria/esportes" class="nav-link">Esportes</a>
                        </li>
                        <li class="nav-item">
                            <a href="/categoria/tecnologia" class="nav-link">Tecnologia</a>
                        </li>
                        <li class="nav-item">
                            <a href="/categoria/saude" class="nav-link">Sa√∫de</a>
                        </li>
                        <li class="nav-item">
                            <a href="/categoria/cultura" class="nav-link">Cultura</a>
                        </li>
                        <li class="nav-item">
                            <a href="/categoria/internacional" class="nav-link">Internacional</a>
                        </li>
                    </ul>
                    
                    <button class="mobile-menu-toggle d-lg-none" aria-label="Menu" aria-expanded="false">
                        <i class="fas fa-bars"></i>
                    </button>
                </div>
            </div>
        </nav>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <div class="row">
                <!-- Profile Sidebar -->
                <div class="col-lg-4">
                    <div class="profile-sidebar">
                        <div class="card">
                            <div class="card-body text-center">
                                <div class="profile-avatar mb-3">
                    <img src="assets/images/default-avatar.png" alt="Avatar" class="rounded-circle" id="profile-avatar">
                                    <div class="avatar-upload">
                                        <input type="file" id="avatar-input" accept="image/*" style="display: none;">
                                        <button class="btn btn-sm btn-outline-primary" onclick="document.getElementById('avatar-input').click()">
                                            <i class="fas fa-camera"></i>
                                        </button>
                                    </div>
                                </div>
                                <h4 class="profile-name" id="profile-name">Nome do Usu√°rio</h4>
                                <p class="profile-email text-muted" id="profile-email">usuario@email.com</p>
                                <div class="profile-stats">
                                    <div class="row">
                                        <div class="col-4">
                                            <div class="stat">
                                                <h5 id="articles-count">0</h5>
                                                <small>Artigos</small>
                                            </div>
                                        </div>
                                        <div class="col-4">
                                            <div class="stat">
                                                <h5 id="comments-count">0</h5>
                                                <small>Coment√°rios</small>
                                            </div>
                                        </div>
                                        <div class="col-4">
                                            <div class="stat">
                                                <h5 id="likes-count">0</h5>
                                                <small>Curtidas</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Quick Actions -->
                        <div class="card mt-4">
                            <div class="card-header">
                                <h5 class="mb-0">A√ß√µes R√°pidas</h5>
                            </div>
                            <div class="card-body">
                                <div class="d-grid gap-2">
                                    <button class="btn btn-primary" onclick="showSection('edit-profile')">
                                        <i class="fas fa-edit"></i> Editar Perfil
                                    </button>
                                    <button class="btn btn-outline-primary" onclick="showSection('change-password')">
                                        <i class="fas fa-lock"></i> Alterar Senha
                                    </button>
                                    <button class="btn btn-outline-primary" onclick="showSection('preferences')">
                                        <i class="fas fa-cog"></i> Prefer√™ncias
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Profile Content -->
                <div class="col-lg-8">
                    <div class="profile-content">
                        <!-- Profile Overview -->
                        <div class="section-content active" id="overview">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0">Vis√£o Geral do Perfil</h5>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <h6>Atividade Recente</h6>
                                            <div class="activity-timeline" id="activity-timeline">
                                                <div class="activity-item">
                                                    <h6>Coment√°rio em "Not√≠cia sobre Tecnologia"</h6>
                                                    <p class="activity-date">H√° 2 horas</p>
                                                </div>
                                                <div class="activity-item">
                                                    <h6>Curtiu "Artigo sobre Economia"</h6>
                                                    <p class="activity-date">H√° 1 dia</p>
                                                </div>
                                                <div class="activity-item">
                                                    <h6>Compartilhou "Not√≠cia sobre Esportes"</h6>
                                                    <p class="activity-date">H√° 3 dias</p>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <h6>Estat√≠sticas</h6>
                                            <div class="stats-grid">
                                                <div class="stat-card">
                                                    <div class="stat-icon">
                                                        <i class="fas fa-eye"></i>
                                                    </div>
                                                    <div class="stat-info">
                                                        <h4 id="profile-views">1,234</h4>
                                                        <p>Visualiza√ß√µes do Perfil</p>
                                                    </div>
                                                </div>
                                                <div class="stat-card">
                                                    <div class="stat-icon">
                                                        <i class="fas fa-calendar"></i>
                                                    </div>
                                                    <div class="stat-info">
                                                        <h4 id="member-since">Jan 2024</h4>
                                                        <p>Membro desde</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Edit Profile Section -->
                        <div class="section-content" id="edit-profile">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0">Editar Perfil</h5>
                                </div>
                                <div class="card-body">
                                    <form id="profile-form">
                                        
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="form-floating">
                                                    <input type="text" class="form-control" id="edit-name" name="nome" placeholder="Nome completo">
                                                    <label for="edit-name">Nome Completo</label>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-floating">
                                                    <input type="email" class="form-control" id="edit-email" name="email" placeholder="Email">
                                                    <label for="edit-email">Email</label>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="form-floating">
                                                    <input type="tel" class="form-control" id="edit-phone" name="telefone" placeholder="Telefone">
                                                    <label for="edit-phone">Telefone</label>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-floating">
                                                    <input type="date" class="form-control" id="edit-birthdate" name="data_nascimento">
                                                    <label for="edit-birthdate">Data de Nascimento</label>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="form-floating">
                                                    <select class="form-select" id="edit-gender" name="genero">
                                                        <option value="">Selecione o g√™nero</option>
                                                        <option value="masculino">Masculino</option>
                                                        <option value="feminino">Feminino</option>
                                                        <option value="outro">Outro</option>
                                                        <option value="prefiro-nao-informar">Prefiro n√£o informar</option>
                                                    </select>
                                                    <label for="edit-gender">G√™nero</label>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="form-floating">
                                            <textarea class="form-control" id="edit-bio" name="bio" placeholder="Biografia" style="height: 100px"></textarea>
                                            <label for="edit-bio">Biografia</label>
                                        </div>
                                        
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="form-floating">
                                                    <input type="text" class="form-control" id="edit-city" name="cidade" placeholder="Cidade">
                                                    <label for="edit-city">Cidade</label>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-floating">
                                                    <select class="form-select" id="edit-state" name="estado">
                                                        <option value="">Selecione o Estado</option>
                                                        <option value="AC">Acre</option>
                                                        <option value="AL">Alagoas</option>
                                                        <option value="AP">Amap√°</option>
                                                        <option value="AM">Amazonas</option>
                                                        <option value="BA">Bahia</option>
                                                        <option value="CE">Cear√°</option>
                                                        <option value="DF">Distrito Federal</option>
                                                        <option value="ES">Esp√≠rito Santo</option>
                                                        <option value="GO">Goi√°s</option>
                                                        <option value="MA">Maranh√£o</option>
                                                        <option value="MT">Mato Grosso</option>
                                                        <option value="MS">Mato Grosso do Sul</option>
                                                        <option value="MG">Minas Gerais</option>
                                                        <option value="PA">Par√°</option>
                                                        <option value="PB">Para√≠ba</option>
                                                        <option value="PR">Paran√°</option>
                                                        <option value="PE">Pernambuco</option>
                                                        <option value="PI">Piau√≠</option>
                                                        <option value="RJ">Rio de Janeiro</option>
                                                        <option value="RN">Rio Grande do Norte</option>
                                                        <option value="RS">Rio Grande do Sul</option>
                                                        <option value="RO">Rond√¥nia</option>
                                                        <option value="RR">Roraima</option>
                                                        <option value="SC">Santa Catarina</option>
                                                        <option value="SP">S√£o Paulo</option>
                                                        <option value="SE">Sergipe</option>
                                                        <option value="TO">Tocantins</option>
                                                    </select>
                                                    <label for="edit-state">Estado</label>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="d-flex gap-2">
                                            <button type="submit" class="btn btn-primary">
                                                <i class="fas fa-save"></i> Salvar Altera√ß√µes
                                            </button>
                                            <button type="button" class="btn btn-outline-secondary" onclick="showSection('overview')">
                                                <i class="fas fa-times"></i> Cancelar
                                            </button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Change Password Section -->
                        <div class="section-content" id="change-password">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0">Alterar Senha</h5>
                                </div>
                                <div class="card-body">
                                    <form id="password-form">
                                        <!-- Campo de usu√°rio oculto para acessibilidade -->
                                        <input type="text" name="username" autocomplete="username" style="display: none;" aria-hidden="true">
                                        <div class="mb-3">
                                            <label for="current-password" class="form-label">Senha Atual</label>
                                            <div class="password-input">
                                                <input type="password" class="form-control" id="current-password" placeholder="Digite sua senha atual" autocomplete="current-password">
                                                <button type="button" class="password-toggle" data-target="current-password" aria-label="Mostrar/ocultar senha">
                                                    <i class="fas fa-eye"></i>
                                                </button>
                                            </div>
                                        </div>
                        
                                        <div class="mb-3">
                                            <label for="new-password" class="form-label">Nova Senha</label>
                                            <div class="password-input">
                                                <input type="password" class="form-control" id="new-password" placeholder="Digite sua nova senha" autocomplete="new-password">
                                                <button type="button" class="password-toggle" data-target="new-password" aria-label="Mostrar/ocultar senha">
                                                    <i class="fas fa-eye"></i>
                                                </button>
                                            </div>
                                        </div>
                        
                                        <div class="mb-3">
                                            <label for="confirm-password" class="form-label">Confirmar Nova Senha</label>
                                            <div class="password-input">
                                                <input type="password" class="form-control" id="confirm-password" placeholder="Confirme sua nova senha" autocomplete="new-password">
                                                <button type="button" class="password-toggle" data-target="confirm-password" aria-label="Mostrar/ocultar senha">
                                                    <i class="fas fa-eye"></i>
                                                </button>
                                            </div>
                                        </div>
                                        
                                        <div class="password-requirements mb-3">
                                            <small class="text-muted">
                                                <strong>Requisitos da senha:</strong><br>
                                                ‚Ä¢ M√≠nimo de 8 caracteres<br>
                                                ‚Ä¢ Pelo menos uma letra mai√∫scula<br>
                                                ‚Ä¢ Pelo menos uma letra min√∫scula<br>
                                                ‚Ä¢ Pelo menos um n√∫mero<br>
                                                ‚Ä¢ Pelo menos um caractere especial
                                            </small>
                                        </div>
                                        
                                        <div class="d-flex gap-2">
                                            <button type="submit" class="btn btn-primary">
                                                <i class="fas fa-lock"></i> Alterar Senha
                                            </button>
                                            <button type="button" class="btn btn-outline-secondary" onclick="showSection('overview')">
                                                <i class="fas fa-times"></i> Cancelar
                                            </button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Preferences Section -->
                        <div class="section-content" id="preferences">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0">Prefer√™ncias</h5>
                                </div>
                                <div class="card-body">
                                    <!-- Notification Preferences -->
                                    <div class="preferences-section">
                                        <h6>Notifica√ß√µes</h6>
                                        <div class="form-check form-switch mb-2">
                                            <input class="form-check-input preference-checkbox" type="checkbox" id="email-notifications" name="email_notifications" data-preference="email_notifications" checked>
                                            <label class="form-check-label" for="email-notifications">
                                                Receber notifica√ß√µes por email
                                            </label>
                                        </div>
                                        <div class="form-check form-switch mb-2">
                                            <input class="form-check-input preference-checkbox" type="checkbox" id="push-notifications" name="push_notifications" data-preference="push_notifications" checked>
                                            <label class="form-check-label" for="push-notifications">
                                                Receber notifica√ß√µes push
                                            </label>
                                        </div>
                                        <div class="form-check form-switch mb-2">
                                            <input class="form-check-input preference-checkbox" type="checkbox" id="newsletter" name="email_newsletter" data-preference="email_newsletter">
                                            <label class="form-check-label" for="newsletter">
                                                Receber newsletter semanal
                                            </label>
                                        </div>
                                    </div>
                                    
                                    <!-- Privacy Preferences -->
                                    <div class="preferences-section">
                                        <h6>Privacidade</h6>
                                        <div class="form-check form-switch mb-2">
                                            <input class="form-check-input preference-checkbox" type="checkbox" id="profile-public" name="profile_public" data-preference="profile_public" checked>
                                            <label class="form-check-label" for="profile-public">
                                                Perfil p√∫blico
                                            </label>
                                        </div>
                                        <div class="form-check form-switch mb-2">
                                            <input class="form-check-input preference-checkbox" type="checkbox" id="show-activity" name="show_activity" data-preference="show_activity">
                                            <label class="form-check-label" for="show-activity">
                                                Mostrar atividade recente
                                            </label>
                                        </div>
                                        <div class="form-check form-switch mb-2">
                                            <input class="form-check-input preference-checkbox" type="checkbox" id="allow-messages" name="allow_messages" data-preference="allow_messages" checked>
                                            <label class="form-check-label" for="allow-messages">
                                                Permitir mensagens de outros usu√°rios
                                            </label>
                                        </div>
                                    </div>
                                        
                                    <!-- Content Preferences -->
                                    <div class="preferences-section">
                                        <h6>Conte√∫do</h6>
                                        <div class="mb-3">
                                            <label class="form-label">Categorias Favoritas</label>
                                            <div id="favorite-categories" class="row">
                                                <div class="col-md-6">
                                                    <div class="form-check mb-2">
                                                        <input class="form-check-input" type="checkbox" id="cat-politica" name="favorite_categories[]" value="politica">
                                                        <label class="form-check-label" for="cat-politica">Pol√≠tica</label>
                                                    </div>
                                                    <div class="form-check mb-2">
                                                        <input class="form-check-input" type="checkbox" id="cat-economia" name="favorite_categories[]" value="economia">
                                                        <label class="form-check-label" for="cat-economia">Economia</label>
                                                    </div>
                                                    <div class="form-check mb-2">
                                                        <input class="form-check-input" type="checkbox" id="cat-esportes" name="favorite_categories[]" value="esportes">
                                                        <label class="form-check-label" for="cat-esportes">Esportes</label>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-check mb-2">
                                                        <input class="form-check-input" type="checkbox" id="cat-tecnologia" name="favorite_categories[]" value="tecnologia">
                                                        <label class="form-check-label" for="cat-tecnologia">Tecnologia</label>
                                                    </div>
                                                    <div class="form-check mb-2">
                                                        <input class="form-check-input" type="checkbox" id="cat-saude" name="favorite_categories[]" value="saude">
                                                        <label class="form-check-label" for="cat-saude">Sa√∫de</label>
                                                    </div>
                                                    <div class="form-check mb-2">
                                                        <input class="form-check-input" type="checkbox" id="cat-entretenimento" name="favorite_categories[]" value="entretenimento">
                                                        <label class="form-check-label" for="cat-entretenimento">Entretenimento</label>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-text mb-2">Selecione suas categorias de interesse</div>
                                        </div>
                                        
                                        <!-- Display Preferences -->
                                        <div class="mb-3">
                                            <label class="form-label">Prefer√™ncias de Exibi√ß√£o</label>
                                            <div class="form-check form-switch mb-2">
                                                <input class="form-check-input preference-checkbox" type="checkbox" id="show-images" name="show_images" data-preference="show_images" checked>
                                                <label class="form-check-label" for="show-images">
                                                    Exibir imagens automaticamente
                                                </label>
                                            </div>
                                            <div class="form-check form-switch mb-2">
                                                <input class="form-check-input preference-checkbox" type="checkbox" id="auto-play-videos" name="auto_play_videos" data-preference="auto_play_videos">
                                                <label class="form-check-label" for="auto-play-videos">
                                                    Reproduzir v√≠deos automaticamente
                                                </label>
                                            </div>
                                            <div class="form-check form-switch mb-2">
                                            <input class="form-check-input preference-checkbox" type="checkbox" id="dark-mode" name="dark_mode" data-preference="dark_mode">
                                            <label class="form-check-label" for="dark-mode">
                                                Modo escuro
                                            </label>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label for="language-preference" class="form-label">Idioma Preferido</label>
                                        <select class="form-select preference-select" id="language-preference" name="language_preference" data-preference="language_preference">
                                            <option value="pt-BR" selected>Portugu√™s (Brasil)</option>
                                            <option value="en-US">English (US)</option>
                                            <option value="es-ES">Espa√±ol</option>
                                        </select>
                                    </div>
                                    
                                    <!-- Bot√µes para salvar e cancelar prefer√™ncias -->
                                    <div class="d-flex gap-2">
                                        <button type="button" class="btn btn-primary" onclick="saveAllPreferences()">
                                            <i class="fas fa-save"></i> Salvar Altera√ß√µes
                                        </button>
                                        <button type="button" class="btn btn-outline-secondary" onclick="showSection('overview')">
                                            <i class="fas fa-times"></i> Cancelar
                                        </button>
                                    </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-lg-4">
                    <div class="footer-section">
                        <div class="footer-logo">
                            <i class="fas fa-newspaper"></i>
                            <span>Portal Not√≠cias</span>
                        </div>
                        <p>Seu portal de not√≠cias confi√°vel, trazendo as informa√ß√µes mais relevantes e atualizadas do Brasil e do mundo.</p>
                        <div class="social-links">
                            <a href="#" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                            <a href="#" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
                            <a href="#" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                            <a href="#" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
                        </div>
                    </div>
                </div>
                <div class="col-lg-2">
                    <div class="footer-section">
                        <h5>Categorias</h5>
                        <ul class="footer-links">
                            <li><a href="/categoria.html?cat=politica">Pol√≠tica</a></li>
                            <li><a href="/categoria.html?cat=economia">Economia</a></li>
                            <li><a href="/categoria.html?cat=esportes">Esportes</a></li>
                            <li><a href="/categoria.html?cat=tecnologia">Tecnologia</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-lg-2">
                    <div class="footer-section">
                        <h5>Mais Categorias</h5>
                        <ul class="footer-links">
                            <li><a href="/categoria.html?cat=saude">Sa√∫de</a></li>
                            <li><a href="/categoria.html?cat=cultura">Cultura</a></li>
                            <li><a href="/categoria.html?cat=mundo">Mundo</a></li>
                            <li><a href="/categoria.html?cat=local">Local</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-lg-2">
                    <div class="footer-section">
                        <h5>Institucional</h5>
                        <ul class="footer-links">
                            <li><a href="/sobre.html">Sobre N√≥s</a></li>
                            <li><a href="/contato.html">Contato</a></li>
                            <li><a href="/equipe.html">Nossa Equipe</a></li>
                            <li><a href="/anuncie.html">Anuncie</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-lg-2">
                    <div class="footer-section">
                        <h5>Legal</h5>
                        <ul class="footer-links">
                            <li><a href="/privacidade.html">Privacidade</a></li>
                            <li><a href="/termos.html">Termos de Uso</a></li>
                            <li><a href="/cookies.html">Cookies</a></li>
                            <li><a href="/rss.xml">RSS</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <div class="row align-items-center">
                    <div class="col-md-6">
                        <p>&copy; 2024 Portal Not√≠cias. Todos os direitos reservados.</p>
                    </div>
                    <div class="col-md-6 text-md-end">
                        <p>Desenvolvido com <i class="fas fa-heart text-danger"></i> pela nossa equipe</p>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Profile Management
        let currentSection = 'overview';
        
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.section-content').forEach(section => {
                section.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(sectionId).classList.add('active');
            currentSection = sectionId;
        }
        
        // Load user data
        async function loadUserData() {
            console.log('üîç Iniciando loadUserData...');
            try {
                // Verifica primeiro 'portal-user' (padr√£o do sistema)
                let token = null;
                const portalUser = localStorage.getItem('portal-user');
                
                if (portalUser) {
                    try {
                        const userData = JSON.parse(portalUser);
                        token = userData.token;
                        console.log('üîë Token encontrado em portal-user:', token ? 'SIM' : 'N√ÉO');
                    } catch (e) {
                        console.log('‚ùå Erro ao parsear portal-user:', e);
                    }
                }
                
                // Fallback para 'authToken' (compatibilidade)
                if (!token) {
                    token = localStorage.getItem('authToken');
                    console.log('üîë Token encontrado em authToken:', token ? 'SIM' : 'N√ÉO');
                }
                
                if (!token) {
                    console.log('‚ùå Nenhum token encontrado, redirecionando para login...');
                    alert('Nenhum token de autentica√ß√£o encontrado. Voc√™ ser√° redirecionado para a p√°gina de login.');
                    window.location.href = 'login.html';
                    return;
                }
                
                console.log('üì° Fazendo requisi√ß√£o para API...');
                const response = await fetch('http://localhost:8001/api/user/profile', {
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                console.log('üìä Status da resposta:', response.status);
                
                if (response.ok) {
                    const result = await response.json();
                    console.log('üìã Dados recebidos:', result);
                    
                    if (result.sucesso && result.dados) {
                        console.log('‚úÖ Populando dados do usu√°rio...');
                        populateUserData(result.dados);
                    } else {
                        console.error('‚ùå Erro ao carregar dados do usu√°rio:', result.mensagem || 'Dados n√£o encontrados');
                    }
                } else {
                    console.error('‚ùå Erro HTTP ao carregar dados do usu√°rio:', response.status);
                }
            } catch (error) {
                console.error('‚ùå Erro na requisi√ß√£o:', error);
            }
        }
        
        function populateUserData(userData) {
            // Update profile info
            document.getElementById('profile-name').textContent = userData.nome || 'Nome do Usu√°rio';
            document.getElementById('profile-email').textContent = userData.email || 'usuario@email.com';
            document.getElementById('user-name').textContent = userData.nome || 'Usu√°rio';
            
            // Update form fields
            document.getElementById('edit-name').value = userData.nome || '';
            document.getElementById('edit-email').value = userData.email || '';
            document.getElementById('edit-phone').value = userData.telefone || '';
            document.getElementById('edit-birthdate').value = userData.data_nascimento || '';
            document.getElementById('edit-bio').value = userData.bio || '';
            document.getElementById('edit-city').value = userData.cidade || '';
            document.getElementById('edit-state').value = userData.estado || '';
            document.getElementById('edit-gender').value = userData.genero || '';
            
            // Update avatar if available
            const avatarElement = document.getElementById('profile-avatar');
            if (avatarElement) {
                if (userData.foto_perfil) {
                    avatarElement.src = userData.foto_perfil;
                } else {
                    avatarElement.src = 'assets/images/default-avatar.png';
                }
            }
            
            // Update notification preferences
            if (document.getElementById('email-notifications')) {
                document.getElementById('email-notifications').checked = userData.email_newsletter || false;
            }
            if (document.getElementById('push-notifications')) {
                document.getElementById('push-notifications').checked = userData.push_breaking || false;
            }
            if (document.getElementById('newsletter')) {
                document.getElementById('newsletter').checked = userData.email_newsletter || false;
            }
            
            // Update privacy preferences
            if (document.getElementById('profile-public')) {
                document.getElementById('profile-public').checked = userData.profile_public !== undefined ? userData.profile_public : true;
            }
            if (document.getElementById('show-activity')) {
                document.getElementById('show-activity').checked = userData.show_activity !== undefined ? userData.show_activity : true;
            }
            if (document.getElementById('allow-messages')) {
                document.getElementById('allow-messages').checked = userData.allow_messages !== undefined ? userData.allow_messages : true;
            }
            
            // Update content preferences (checkboxes)
            if (userData.favorite_categories) {
                const favoriteCategories = Array.isArray(userData.favorite_categories) ? userData.favorite_categories : JSON.parse(userData.favorite_categories || '[]');
                const checkboxes = document.querySelectorAll('input[name="favorite_categories[]"]');
                checkboxes.forEach(checkbox => {
                    checkbox.checked = favoriteCategories.includes(checkbox.value);
                });
            }
            
            if (document.getElementById('language-preference') && userData.language_preference) {
                document.getElementById('language-preference').value = userData.language_preference;
            }
        }
        
        // Handle profile form submission
        document.getElementById('profile-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = {
                nome: document.getElementById('edit-name').value,
                email: document.getElementById('edit-email').value,
                telefone: document.getElementById('edit-phone').value,
                data_nascimento: document.getElementById('edit-birthdate').value,
                bio: document.getElementById('edit-bio').value,
                cidade: document.getElementById('edit-city').value,
                estado: document.getElementById('edit-state').value,
                genero: document.getElementById('edit-gender').value
            };
            
            try {
                // Obter token usando a mesma l√≥gica do loadUserData
                let token = null;
                const portalUser = localStorage.getItem('portal-user');
                
                if (portalUser) {
                    try {
                        const userData = JSON.parse(portalUser);
                        token = userData.token;
                    } catch (e) {
                        console.log('‚ùå Erro ao parsear portal-user:', e);
                    }
                }
                
                if (!token) {
                    token = localStorage.getItem('authToken');
                }
                
                if (!token) {
                    alert('Token de autentica√ß√£o n√£o encontrado. Fa√ßa login novamente.');
                    window.location.href = 'login.html';
                    return;
                }
                
                const response = await fetch('http://localhost:8001/api/user/profile', {
                    method: 'PUT',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData)
                });
                
                if (response.ok) {
                    alert('Perfil atualizado com sucesso!');
                    loadUserData(); // Reload user data
                    showSection('overview');
                } else {
                    alert('Erro ao atualizar perfil');
                }
            } catch (error) {
                console.error('Erro na requisi√ß√£o:', error);
                alert('Erro ao atualizar perfil');
            }
        });
        
        // Handle password change form submission
        document.getElementById('password-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const currentPassword = document.getElementById('current-password').value;
            const newPassword = document.getElementById('new-password').value;
            const confirmPassword = document.getElementById('confirm-password').value;
            
            if (newPassword !== confirmPassword) {
                alert('As senhas n√£o coincidem');
                return;
            }
            
            // Password validation
            const passwordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;
            if (!passwordRegex.test(newPassword)) {
                alert('A senha n√£o atende aos requisitos m√≠nimos');
                return;
            }
            
            try {
                // Verifica primeiro 'portal-user' (padr√£o do sistema)
                let token = null;
                const portalUser = localStorage.getItem('portal-user');
                
                if (portalUser) {
                    try {
                        const userData = JSON.parse(portalUser);
                        token = userData.token;
                    } catch (e) {
                        console.log('Erro ao parsear portal-user:', e);
                    }
                }
                
                // Fallback para 'authToken' (compatibilidade)
                if (!token) {
                    token = localStorage.getItem('authToken');
                }
                
                if (!token) {
                    alert('Token de autentica√ß√£o n√£o encontrado');
                    return;
                }
                
                const response = await fetch('http://localhost:8001/api/user/change-password', {
                    method: 'PUT',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        current_password: currentPassword,
                        new_password: newPassword,
                        confirm_password: confirmPassword
                    })
                });
                
                if (response.ok) {
                    alert('Senha alterada com sucesso!');
                    document.getElementById('password-form').reset();
                    showSection('overview');
                } else {
                    alert('Erro ao alterar senha');
                }
            } catch (error) {
                console.error('Erro na requisi√ß√£o:', error);
                alert('Erro ao alterar senha');
            }
        });
        
        // Function to get authentication token
        function getAuthToken() {
            let token = null;
            const portalUser = localStorage.getItem('portal-user');
            
            if (portalUser) {
                try {
                    const userData = JSON.parse(portalUser);
                    token = userData.token;
                } catch (e) {
                    console.log('Erro ao parsear portal-user:', e);
                }
            }
            
            if (!token) {
                token = localStorage.getItem('authToken');
            }
            
            return token;
        }
        
        // Function to save all preferences
        async function saveAllPreferences() {
            try {
                const token = getAuthToken();
                if (!token) {
                    alert('Token de autentica√ß√£o n√£o encontrado. Fa√ßa login novamente.');
                    window.location.href = 'login.html';
                    return;
                }
                
                // Collect favorite categories
                const categoryCheckboxes = document.querySelectorAll('input[name="favorite_categories[]"]');
                const selectedCategories = [];
                categoryCheckboxes.forEach(checkbox => {
                    if (checkbox.checked) {
                        selectedCategories.push(checkbox.value);
                    }
                });
                
                // Collect all preferences in the format expected by backend
                const preferences = {
                    notifications: {
                        email: document.getElementById('email-notifications')?.checked || false,
                        push: document.getElementById('push-notifications')?.checked || false,
                        newsletter: document.getElementById('newsletter')?.checked || false
                    },
                    privacy: {
                        profile_public: document.getElementById('profile-public')?.checked || false,
                        show_activity: document.getElementById('show-activity')?.checked || false,
                        allow_messages: document.getElementById('allow-messages')?.checked || false
                    },
                    content: {
                        show_images: document.getElementById('show-images')?.checked || false,
                        auto_play_videos: document.getElementById('auto-play-videos')?.checked || false,
                        dark_mode: document.getElementById('dark-mode')?.checked || false,
                        language: document.getElementById('language-preference')?.value || 'pt-BR'
                    },
                    favorite_categories: selectedCategories
                };
                
                const response = await fetch('http://localhost:8001/api/user/preferences', {
                    method: 'PUT',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(preferences)
                });
                
                if (response.ok) {
                    alert('Altera√ß√µes salvas com sucesso!');
                    showSection('overview');
                } else {
                    alert('Erro ao salvar altera√ß√µes');
                }
            } catch (error) {
                console.error('Error saving preferences:', error);
                alert('Erro ao salvar altera√ß√µes');
            }
        }
        
        // Handle avatar upload
        document.getElementById('avatar-input').addEventListener('change', async function(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            // Validate file type
            if (!file.type.startsWith('image/')) {
                alert('Por favor, selecione uma imagem v√°lida');
                return;
            }
            
            // Validate file size (max 5MB)
            if (file.size > 5 * 1024 * 1024) {
                alert('A imagem deve ter no m√°ximo 5MB');
                return;
            }
            
            try {
                // Convert file to base64
                const base64 = await fileToBase64(file);
                
                // Verifica primeiro 'portal-user' (padr√£o do sistema)
                let token = null;
                const portalUser = localStorage.getItem('portal-user');
                
                if (portalUser) {
                    try {
                        const userData = JSON.parse(portalUser);
                        token = userData.token;
                    } catch (e) {
                        console.log('Erro ao parsear portal-user:', e);
                    }
                }
                
                // Fallback para 'authToken' (compatibilidade)
                if (!token) {
                    token = localStorage.getItem('authToken');
                }
                
                if (!token) {
                    alert('Token de autentica√ß√£o n√£o encontrado');
                    return;
                }
                
                const response = await fetch('http://localhost:8001/api/user/avatar', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        image: base64
                    })
                });
                
                if (response.ok) {
                    const result = await response.json();
                    
                    if (result.success) {
                        document.getElementById('profile-avatar').src = result.avatar_url;
                        alert('Avatar atualizado com sucesso!');
                        // Reload user data to get updated profile
                        loadUserData();
                    } else {
                        alert(result.message || 'Erro ao fazer upload do avatar');
                    }
                } else {
                    const errorData = await response.json();
                    alert(errorData.message || 'Erro ao fazer upload do avatar');
                }
            } catch (error) {
                console.error('Erro na requisi√ß√£o:', error);
                alert('Erro ao fazer upload do avatar');
            }
        });
        
        // Helper function to convert file to base64
        function fileToBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => resolve(reader.result);
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        }
        
        // Password toggle functionality
        document.querySelectorAll('.password-toggle').forEach(button => {
            button.addEventListener('click', function() {
                const targetId = this.getAttribute('data-target');
                const passwordInput = document.getElementById(targetId);
                const icon = this.querySelector('i');
                
                if (passwordInput.type === 'password') {
                    passwordInput.type = 'text';
                    icon.classList.remove('fa-eye');
                    icon.classList.add('fa-eye-slash');
                    this.setAttribute('aria-label', 'Ocultar senha');
                } else {
                    passwordInput.type = 'password';
                    icon.classList.remove('fa-eye-slash');
                    icon.classList.add('fa-eye');
                    this.setAttribute('aria-label', 'Mostrar senha');
                }
            });
        });
        
        // Logout function
        function logout() {
            if (confirm('Tem certeza que deseja sair?')) {
                localStorage.removeItem('authToken');
                localStorage.removeItem('portal-user');
                localStorage.removeItem('userData');
                window.location.href = 'login.html';
            }
        }
        
        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            loadUserData();
        });
        
        // Make saveAllPreferences globally available
        window.saveAllPreferences = saveAllPreferences;
    </script>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Main JS -->
    <script src="assets/js/main.js"></script>
</body>
</html>